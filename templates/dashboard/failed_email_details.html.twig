{# filepath: d:\prog\php\project\choven.by\templates\admin\failed_email_details.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Детали неудачного письма{% endblock %}

{% block head %}
    {% block stylesheets %}
        {{ parent() }}
        <style>
            .email-details {
                padding: 30px 0;
            }
            .email-details-title {
                margin-bottom: 30px;
                border-bottom: 2px solid #f0f0f0;
                padding-bottom: 10px;
            }
            .email-card {
                background-color: #fff;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                padding: 20px;
                margin-bottom: 20px;
            }
            .email-card h3 {
                margin-top: 0;
                border-bottom: 1px solid #f0f0f0;
                padding-bottom: 10px;
                margin-bottom: 15px;
            }
            .info-row {
                display: flex;
                margin-bottom: 15px;
            }
            .info-label {
                font-weight: 600;
                width: 180px;
                flex-shrink: 0;
            }
            .info-value {
                flex-grow: 1;
            }
            .back-link {
                display: inline-block;
                margin-top: 20px;
                text-decoration: none;
                color: #007bff;
            }
            .back-link:hover {
                text-decoration: underline;
            }
            .context-data {
                background-color: #f8f9fa;
                border-radius: 4px;
                padding: 15px;
                overflow-x: auto;
                max-height: 300px;
                overflow-y: auto;
            }
            .error-message {
                background-color: #f8d7da;
                border-radius: 4px;
                padding: 15px;
                color: #721c24;
                margin-bottom: 15px;
            }
            pre {
                margin: 0;
                white-space: pre-wrap;
            }
        </style>
    {% endblock %}
{% endblock %}

{% block body %}
    <section class="email-details">
        <div class="container">
            <h1 class="email-details-title">Детали неудачного письма #{{ email.id }}</h1>
            
            <div class="email-card">
                <h3>Основная информация</h3>
                
                <div class="info-row">
                    <div class="info-label">ID:</div>
                    <div class="info-value">{{ email.id }}</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Тип письма:</div>
                    <div class="info-value">{{ email.emailType }}</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Количество попыток:</div>
                    <div class="info-value">{{ email.attempts }}</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Дата создания:</div>
                    <div class="info-value">{{ email.createdAt|date('d.m.Y H:i:s') }}</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Последняя попытка:</div>
                    <div class="info-value">{{ email.lastAttemptAt|date('d.m.Y H:i:s') }}</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Локаль:</div>
                    <div class="info-value">{{ email.locale|default('default') }}</div>
                </div>
            </div>
            
            {% if email.error %}
                <div class="email-card">
                    <h3>Сообщение об ошибке</h3>
                    <div class="error-message">
                        <pre>{{ email.error }}</pre>
                    </div>
                </div>
            {% endif %}
            
            <div class="email-card">
                <h3>Контекст письма</h3>
                <div class="context-data">
                    <pre>{{ email.context|json_encode(constant('JSON_PRETTY_PRINT')) }}</pre>
                </div>
            </div>
            
            <a href="{{ path('app_admin_failed_emails') }}" class="back-link">&laquo; Вернуться к списку</a>
        </div>
    </section>
{% endblock %}